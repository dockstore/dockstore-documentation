Digital Object Identifiers
==========================

Introduction
------------
A Digital Object Identifier (DOI) is a permanent identifier that can be used in publications to identify the exact
version of a workflow or tool (entry). DOIs are commonly referenced from academic papers.
See the `DOI Foundation <https://www.doi.org>`__ for more details.

Creating and assigning DOIs is commonly known as "minting". Many repositories mint DOIs. Dockstore currently
only supports `Zenodo <https://zenodo.org>`__ DOIs. Dockstore uses Zenodo to mint DOIs, and it can also recognize DOIs generated by Zenodo outside of Dockstore.

Zenodo supports `DOI versioning <https://support.zenodo.org/help/en-gb/1-upload-deposit/97-what-is-doi-versioning>`__  with a concept DOI for an overall record, and version-specific DOIs.

In Dockstore, the concept DOI is associated with the entry as a whole, and version DOIs are associated with entry versions.

Dockstore Support for DOIs
--------------------------

Dockstore can generate DOIs for entries, as well as recognize some DOIs generated outside of Dockstore. Dockstore displays DOIs associated with entries. If you have multiple concept DOIs associated
with a single entry, you can specify which DOI to display.

Dockstore generates DOIs for entries 2 ways:

* Explicitly initiated by a Dockstore user. This approach requires you linking your Zenodo account. You select a version via the Dockstore UI and click to create a DOI. See :doc:`Creating Snapshots & Requesting DOIs </advanced-topics/snapshot-and-doi>` for more details
* Dockstore can automatically generate DOIs for your entries without you needing to link your Zenodo account. These DOIs are created in the Dockstore Zenodo Community

In addition, Dockstore can discover DOIs created by a Zenodo-GitHub integration.

Choosing which DOI to display
-----------------------------

When viewing the public page of an entry, the entry's concept DOI and the selected version's DOI are displayed.

.. figure:: /assets/images/docs/show-doi.png
   :alt: Show DOIs

Dockstore only displays one DOI associated with a entry, even if there is more than one DOI, e.g., one generated by GitHub-Zenodo integration, and another generated by Dockstore.
If this situation arises, you can control which DOI is displayed via your dashboard. 

Select the entry, then click Manage DOIs, and you'll get a dialog like this. 
Under DOI selection, click the radio button for the DOI you want to display and your DOI selection will update immediately. Click Done to close the dialog.

   
.. figure:: /assets/images/docs/manage-dois.png
   :alt: Manage DOIs


Overview of the different ways of issuing DOIs
----------------------------------------------

With the different ways Dockstore supports DOIs, it may be confusing as to how to generate DOIs for your Dockstore entries.  Following are some details on the differences.


Creating Snapshots & Requesting DOIs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

See :doc:`Creating Snapshots & Requesting DOIs </advanced-topics/snapshot-and-doi>` for more details

* You must initiate the DOI creation for each version

    * More control over when DOIs are created
    * You have to individually do it for every tag
* The DOIs are minted in the Zenodo Dockstore community
* Version on Dockstore is snapshotted (frozen)
* Requires a Zenodo account that you link to your Dockstore account

Automatic Dockstore DOI Generation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Dockstore will automatically mint a DOI for a version that corresponds to a Git tag, if:

* The entry is published on Dockstore
* The version is valid and has at least one author in its metadata
* The tag is created after you publish the entry, or the tag is one of the 10 most recent when you publish the entry

Automatically-generated DOIs:

* Do not require a Zenodo account
* Are minted in the `Zenodo Dockstore community <https://zenodo.org/communities/dockstore>`__
* Are editable by request to the Dockstore team
* Will be editable via a Zenodo account in a subsequent Dockstore release

If you wish to override and disable this feature, you can opt-out on a per-entry basis.

For GitHub App entries, add the following setting to your .dockstore.yml files. This is a workflow-wide setting that will affect ALL branches/tags; only set this as needed in a main branch.
For more information, view the :doc:`full .dockstore.yml template </assets/templates/template>` for your entry which includes an explanation of this field.

.. code-block:: yaml

   enableAutoDois: false

For hosted workflows and workflows that were registered using our :doc:`legacy registration methods </advanced-topics/legacy/workflow-legacy-registration>`, 
navigate to your workflow and click the Manage DOIs button. The Manage DOIs dialog will open and you can click the Automatic DOI Generation toggle to disable this feature.

.. figure:: /assets/images/docs/toggle-auto-doi.png
   :alt: Disable automatic DOI generation

One rare case to potentially watch out for: if your workflows are tagged with your ORCID as an author
you may get a large number of notifications or workflows automatically added to your ORCID profile.
This will occur outside of Dockstore if you have the `ORCID Auto-Update <https://support.datacite.org/docs/datacite-and-orcid#2-orcid-auto-update>`__ feature turned on in DataCite.
DataCite's auto-update feature is not aware of how Zenodo groups DOIs into one overall "concept" DOI and will import each version independently.

GitHub-Zenodo Generation
~~~~~~~~~~~~~~~~~~~~~~~~

Zenodo has a feature where you can link your GitHub account, then specify repositories where Zenodo automatically mints DOIs when GitHub releases are created. Note that a GitHub release is not the
same as a Git tag; GitHub releases require Git tags, but have extra features.

To set up and configure your Zenodo-GitHub integration, navigate to `Zenodo GitHub account settings <https://zenodo.org/account/settings/github/>`__.

The DOIs created by this integration follow a certain pattern that Dockstore can detect. Dockstore will poll Zenodo to see if any new DOIs have been created against Dockstore entries' GitHub repositories.

* Automatic
* Only mints DOIs for GitHub releases
* Can mint DOIs for GitHub repos without associated workflows in Dockstore

    * Useful for minting DOIs for GitHub repositories that aren't workflows or tools
    * Can mint DOIs for entries that haven't yet been registered in Dockstore

Summary of Differences
~~~~~~~~~~~~~~~~~~~~~~

+--------------------------------+-------------------------+-------------------+-------------------------------------+
| Generation Type                | Zenodo Account Required | Snapshot Required | Triggered by                        |
+================================+=========================+===================+=====================================+
| Manual by Dockstore User       | Yes                     | Yes               | User request                        |
+--------------------------------+-------------------------+-------------------+-------------------------------------+
| Automatically by Dockstore     | No                      | No                | Push of a Git tag to GitHub for     |
|                                |                         |                   |                                     |
|                                |                         |                   | a published Dockstore entry, or     |
|                                |                         |                   |                                     |
|                                |                         |                   | on publication of entry             |
+--------------------------------+-------------------------+-------------------+-------------------------------------+
| Zenodo-GitHub integration      | Yes                     | No                | GitHub release for a repository     |
|                                |                         |                   |                                     |
|                                |                         |                   | with a published Dockstore entry    |
+--------------------------------+-------------------------+-------------------+-------------------------------------+



.. discourse::
    :topic_identifier: 9175
