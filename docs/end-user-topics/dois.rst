DOIs
====

Introduction
------------
A Digial Object Identifier (DOI) is a permanent identifier that can be used in publications to identify the exact
version of a workflow or tool (entry). DOIs are commonly referenced from academic papers.
See the `DOI Foundation <https://www.doi.org>`__ for more details.

A Dockstore entry that has a DOI will have a concept DOI, which is a DOI referencing the entire entry, and potentially many version DOIs -- one DOI per version. The concept DOI represents all versions and will resolve to the latest version.

Dockstore Support for DOIs
--------------------------

Dockstore can generate DOIs for entries, as well as recognize some DOIs generated outside of Dockstore. Dockstore displays DOIs associated with entries. If you have multiple concept DOIs associated
with a single entry, you can specify which DOI to display.

Dockstore can generate DOIs for entries 2 ways:

* Explicitly initiated by a Dockstore user. This approach requires you linking your Zenodo account. You select a version via the Dockstore UI and click to create a DOI. See :doc:`Creating Snapshots & Requesting DOIs </advanced-topics/snapshot-and-doi>` for more details.
* Dockstore can automatically generate DOIs for your entries without you needing to link your Zenodo account. These DOIs are created in the Dockstore Zenodo Community.

In addition, Dockstore can discover DOIs created by a Zenodo-GitHub integration.

Choosing which DOI to display
-----------------------------

When viewing the public page of an entry, the entry's concept DOI and the selected version's DOI are displayed.

.. figure:: /assets/images/docs/show-doi.png
   :alt: Show DOIs

Dockstore only displays one DOI associated with a entry, even if there is more than one DOI, e.g., one generated by GitHub-Zenodo integration, and another generated by Dockstore.
If this situation arises, you can control which DOI is displayed on your dashboard. Select the entry, then click "Manage DOIs", and you'll get a dialog like this. Select your choice
and click "Save".

   
.. figure:: /assets/images/docs/manage-dois.png
   :alt: Manage DOIs


Comparison of the different ways of issuing DOIs
------------------------------------------------

With the different ways Dockstore supports DOIs, it may be confusing as to how to generate DOIs for your Dockstore entries. There are tradeoffs for each method. Here's a high level overview of some of the features of each.


Creating Snapshots & Requesting DOIs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

These DOIs are initiated by entry owners. The entry owner has to explicitly initiate the process, either via the Dockstore UI or the Dockstore API. If issuing a DOI this way, you first need to `snapshot` your version.
Snapshotting a version makes it immutable, so that no further modifications to the version are allowed by Dockstore.

This approach requires you to have a Zenodo account and link it in Dockstore.


* You must initiate the DOI creation
    * More control over when DOIs are created
    * More cumbersome, you have to individually do it for every tag
* Version on Dockstore is snapshotted, which means it will ignore any future changes made on GitHub. This is typically the behavior you want with a tag, but Git tags can be deleted and recreated.
* Requires a Zenodo account, and that you link your account to Dockstore

Automatic Dockstore DOI Generation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. note::
    This feature is currently only available on request. Please contact the Dockstore team at `discuss.dockstore.org <https://discuss.dockstore.org/t/opening-helpdesk-tickets/1506>`__ if you want to participate.

Dockstore automatically generates a DOI for published GitHub based entries every time a Git tag is pushed to GitHub. This DOI will be published as part of the Dockstore Zenodo community.
You do not need a Zenodo account for this DOI to be created, although you will need a Zenodo account to edit the DOI.

* You don't have to do anything; the DOIs are automatically created when Git tags are pushed
* Generates DOIs for all tags, regardless of whether there is also a GitHub release
* The DOI will be in the Zenodo Dockstore community
* No Zenodo account is required, although it's recommended

GitHub-Zenodo Generation
~~~~~~~~~~~~~~~~~~~~~~~~

Zenodo has a feature where you can link your GitHub account, then for specified repositories, Zenodo automatically generates DOIs when GitHub releases are created. Note that a GitHub release is not the
same as a Git tag; GitHub releases require Git tags, but have extra features.

To set up and configure your Zenodo-GitHub integration, navigate to `Zenodo GitHub account settings <https://zenodo.org/account/settings/github/>`__.

The DOIs created by this integration follow a certain pattern that Dockstore can detect. Dockstore will poll Zenodo GitHub to see if any new DOIs have been created by Zenodo.

* It's automatic
* Only generates DOIs for GitHub releases
* Also generates DOIs for GitHub repos without associated workflows in Dockstore
    * Useful for generating DOIs for GitHub repositories that aren't workflows or tools
    * Can generate DOIs for entries that haven't yet been registered in Dockstore
